# EspHome-Diplay-Gauge
### Gauge-component for visualizing parameters on a graphical display in EspHome 
### Компонент для EspHome, позволяющий нарисовать индикатор "градусник" на дисплее.

![1](https://github.com/Brokly/EspHome-Diplay-Gauge/assets/11642286/1eff9829-f386-4a47-89bb-4d98d5f458d3)
![2](https://github.com/Brokly/EspHome-Diplay-Gauge/assets/11642286/f605f2eb-de23-47f4-8e51-105672fb7c70)

### Устройство из семейства FloatOutput. 
Для использования разместить папку с комплектом файлов компонента в дополнительной дирректории. В моем случае это папка my_components, лежащая рядом с конфигурацияей (yaml файлом) вашего устройства. А в папке my_components находится папка display_gauge, с комплектом файлов из одноименной папки данного репозитория. Для подключения компонента к проекту вы должны внести в yaml файл следующий блок:

```yaml
external_components:
  - source:
      type: local
      path: my_components
```

После этого вы можете создать любое количество "градусников" на вашем дисплее

```yaml
output:
  
  #градусник 1
  - platform: display_gauge
    id: test_gauge1_id       # ID градусника, для дальнейшей его визуализации
    display: my_display      # Дисплей на котором рисуется этот градусник (не обязательный параметр), в его отсутствии отрисовка будет происходить на первом дисплее
    start_angle: 5           # стартовый угол (начало градусника) в градусах от 0 до 359, (не обязательный параметр, по умолчанию: 50)
    end_angle: 120           # конечный угол (конец градусника)  в градусах от 0 до 359, (не обязательный параметр, по умолчанию: 310)
    radius: 56               # радиус градусника (не обязательный параметр, по умолчанию: 50)
    height: 14               # общая ширина градусника (не обязательный параметр, по умолчанию: 14)
    center_x: 64             # координата X центра дуги градусника (обязательный параметр)
    center_y: 64             # координата Y центра дуги градусника (обязательный параметр)
    color: my_blue           # цвет линии заполнения градусника, либо начальный цвет (не обязательный параметр, по умолчанию: белый)
    full_color: my_yellow    # цвет линии заполнения градусника при максимальных показаниях (не обязательный параметр), в отсутствии заполнение будет одного цвета и не будет зависеть от показаний
    border_color: my_white   # цвет бордюра (не обязательный параметр), в отсутствии параметра цвет аналогичный линии заполнения
    style_soft: true         # стиль, при TRUE торцы градусника закруглены (не обязательный параметр, по умолчанию: true)
    auto_refresh: true       # включает отрисовку при установке нового значения показаний (не обязательный параметр, по умолчанию: true), при false отрисовка будет происходить только принудительно обращением к процедуре repaint()
    mirroring: false         # изменяет направление заполнения градусника с "по часовой стрелке" на "против часовой стрелки" (не обязательный параметр, по умолчанию: false)
  
  #градусник 2
  - platform: display_gauge
    id: test_gauge2_id
    display: my_display
    start_angle: 30
    end_angle: 170
    radius: 39
    height: 14
    center_x: 64
    center_y: 64
    full_color: my_red
    color: my_blue
    border_color: my_green    
    style_soft: false
    auto_refresh: false  
    mirroring: true
```

### Использование в стиле конфига yaml: 

```yaml
on_...:
  then:
    # установит показания индикатора test_gauge2_id в положение 50%
    - output.set_level: 
        id: test_gauge1_id
        level: 50% #
```

### Использование в лямбдах: 

В примере переменная val содержит показания 25.5. Предполагается, что диапазон отображения градусников от -30.0 до 40.0. Поскольку градусник является наследником float output он принимает значения лежащие в диапазоне от 0.0 до 1.0 . В переменной koef, пересчитанные данные. Используя диапазон отображения приводим показания к требуемому диапазону.

```yaml
   lambda: |-
      float val=25.5;
      float koef=(val+30.0)/(40.0+30.0); // пересчет показаний в диапазон 0.0 ... 1.0
      id(test_gauge1_id).set_level(koef); // установка показаний грдусников      
      id(test_gauge2_id).set_level(koef);
      id(test_gauge2_id).repaint(); // принудительная отрисовка градусника
```


https://github.com/Brokly/EspHome-Diplay-Gauge/assets/11642286/361e95d7-70fe-4103-83b6-468b08ad0fea

